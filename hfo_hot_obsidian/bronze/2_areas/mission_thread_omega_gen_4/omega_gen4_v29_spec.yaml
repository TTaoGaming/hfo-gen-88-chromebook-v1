# Medallion: Bronze | Mutation: 0% | HIVE: ⚔️
# OMEGA GEN 4 V29.0 SPECIFICATION
# Focus: Absolute UPE Authority, Zero-CDN Parity, Operator Loop Lock

mission_objectives:
  - id: P0_LOCAL_ASSETS
    status: HARD_REQUIREMENT
    description: "Phase 4 - Zero-CDN. Use local FilesetResolver base path. Load WASM and .task models from lib/mediapipe/."
    source: omega_gen4_v25_spec

  - id: P1_UPE_AUTHORITY
    status: CRITICAL
    description: "Make UPE truly authoritative. No other code should compute clientX/clientY mappings or zoom margins outside UPE to eliminate edge-reach distortion."

  - id: P7_OPERATOR_LOCK
    status: ESSENTIAL
    description: "Implement Essentials/Developer gate. Single readiness gauge as the only 'arming truth' in the UI to ensure one successful click in 30s without noise."
    source: omega_gen4_v25_spec

technical_debt:
  - id: EDGE_DISTORTION
    type: COORDINATE_DRIFT
    description: "Reported coordinate distortion at screen edges due to non-UPE calculations."

  - id: CDN_DEPENDENCY
    type: INFRASTRUCTURE_FRAGILITY
    description: "Relying on unpkg.com and jsdelivr causes latency and offline failure."

  - id: DEBUG_NOISE
    type: UX_FRICTION
    description: "UI clutter during arming sequence interferes with mission operations."

findings:
  - id: IFRAME_OFFSET_DRIFT
    description: "Manual iframeRect.left/top subtractions in dispatchToHydraHydrant caused parity drift at edges. Fixed by centralizing toClientX/Y in UPE."
  - id: ZOOM_OFFSET_CONSISTENCY
    description: "Inconsistent use of offsetX/offsetY variables across drawing vs interaction layers. UPE now enforces these globally."

hypothesis_search_space:
  - id: CONTAINMENT_PARADOX_CALIBRATION
    hypothesis: "The browser's object-fit: contain logic for the video-feed creates dynamic margins (letterboxing) that are not accounted for in basic clientRect calculations. UPE must detect the aspect-ratio delta between the container and the video stream to subtract these invisible pixels."
    action: "Implement a 'Calibration Marker' (e.g. 4 corner dots) to verify 1:1 parity during initialize."

  - id: LOCAL_ASSET_INTEGRITY_VERIFICATION
    hypothesis: "Previous localization failures (404-as-JS) were 'green lies' because we only checked HTTP status, not content. We must enforce file-size and 'JS-validity' checks (e.g. grep for keywords) before promoting to Silver."
    action: "Create a Python pre-flight script to SHA-256 local libs against CDN headers."

  - id: PERMISSIONS_POLICY_DEADLOCK
    hypothesis: "Permissions Policy violations for 'unload' and 'focus' in Excalidraw sub-frames are symptoms of synthetic event distrust. We need to explore 'User-Intent Priming'—triggering a real invisible click from a legitimate user interaction to unlock the focus proxy."

evaluation_hardening:
  - id: ARMORED_PRECOMMIT_HOOK
    strategy: "Modify .git/hooks/pre-commit to execute a full P5 Forensic Audit of the specific .html modified. If aggregate_status is FAIL, commit is blocked."
  - id: SENTINEL_DAEMON_ENFORCEMENT
    strategy: "Enhance scripts/p5_sentinel_daemon.py to watch for 'Slop' (empty stubs) and 'Green Lies' (missing local assets) in real-time, emitting RED_TRUTH signals to the terminal."
  - id: QUAD_BFT_HARDENING
    strategy: "Increase BFT Consensus threshold from 0.75 for all 'V' (Validate) phases. A single dissenting shard with a 'Theater' flag should block promotion."
