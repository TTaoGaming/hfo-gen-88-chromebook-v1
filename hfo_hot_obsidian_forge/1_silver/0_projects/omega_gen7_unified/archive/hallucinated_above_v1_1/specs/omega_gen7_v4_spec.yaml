# Medallion: Bronze | Mutation: 0% | HIVE: V
# Omega Mission Thread — Gen7 v4 Spec: Hand Coast + Snapback + Multi-hand Stability
# Timestamp: 2026-01-25
# Provenance: fork/evolve from Gen7 v3 spec.
# Posture: Spec-first (likely RED) — focus is identity stability and multi-hand correctness.

meta:
  generation: 7
  version: 4
  status: "bronze-spec-red"
  theme: "v4 = coast/snapback + multi-hand stability"
  theme_one_liner: "Identity stability first (coast + snapback), then multi-hand isolation/correctness."
  intent:
    - "Focus on hand coast/snapback (identity stability) as the primary evolution axis."
    - "Harden multi-hand support: N hands concurrently without identity collision or cross-talk."
    - "Preserve v3 fingertip pipeline shape, but prioritize correctness and stability over new features."

entrypoint:
  base:
    html: hfo_hot_obsidian/bronze/1_projects/omega_gen7_current/app/omega_gen7_v1.html
  target:
    planned_html: hfo_hot_obsidian/bronze/1_projects/omega_gen7_current/app/omega_gen7_v4.html
    note: "Spec-only: Gen7 v2+ HTML entrypoints are intentionally absent until promoted."

lineage:
  artifact_kind: "spec"
  artifact_id: "omega_gen7_v4_spec"
  parents:
    - artifact_id: "omega_gen7_v3_spec"
      path: "hfo_hot_obsidian/bronze/1_projects/omega_gen7_current/specs/omega_gen7_v3_spec.yaml"
  notes:
    - "Non-destructive evolution: v3 remains valid as the multi-fingertip intent; v4 is a stability bud."

stability_focus:
  hand_identity:
    must_have:
      - "Coast: brief detection dropouts do not churn identities; slot persists for hold_ms."
      - "Snapback: returning detections within snaplock radius reattach to prior slot (side-consistent)."
      - "Fail-stable: reject swaps/teleports unless evidence exceeds swap threshold."
      - "Deterministic identity keys for downstream mapping: handKey is required for all per-hand computations."
    knobs:
      hold_ms_default: 400
      max_jump_uiNorm_default: 0.18
      swap_hysteresis_ms_default: 500
      snaplock_radius_uiNorm_default: 0.07

multi_hand:
  posture:
    - "Do not assume 1–2 hands; support N hands concurrently."
    - "Per-hand state machines and key-mappers must be isolated (no shared mutable state between hands)."
  invariants:
    - "No identity collision: two hands cannot share the same handKey at the same time."
    - "No cross-talk: events emitted for HAND_A must never cause key output for HAND_B."

validation:
  posture: "RED-first (identity stability + multi-hand isolation)"
  acceptance_criteria:
    - "With N hands present, each hand maintains a stable handKey across typical detector churn."
    - "During brief dropouts (< hold_ms_default), handKey remains stable and state coasts."
    - "On reappearance within snaplock radius, the prior slot snaps back without swapping with another hand."
    - "If detector ordering flips, handKey assignment remains stable (fail-stable)."

sources:
  - hfo_hot_obsidian/bronze/1_projects/omega_gen7_current/specs/omega_gen7_v3_spec.yaml
